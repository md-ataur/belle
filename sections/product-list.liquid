{% if section.settings.products_per_page %}
  {%- assign limit = section.settings.products_per_page -%}
{% endif %}

{% if section.settings.products_per_row %}
  {%- assign per_row = section.settings.products_per_row -%}
{% endif %}

{% paginate collection.products by limit %}
  <!--Collection Banner-->
  <div class="collection-header">
    <div class="collection-hero">
      <div class="collection-hero__image">
        <img class="blur-up lazyload" data-src="{{ collection.image.src | img_url: 'master' }}" src="{{ collection.image.src | img_url: 'master' }}" alt="Women" title="Women" />
      </div>
      <div class="collection-hero__title-wrapper">
        <h1 class="collection-hero__title page-width">{{ collection.title }}</h1>
      </div>
    </div>
  </div>
  <!--End Collection Banner-->

  <div class="container">
    <div class="row">
      <!--Sidebar-->
      <div class="col-12 col-sm-12 col-md-3 col-lg-3 sidebar filterbar">
        <div class="closeFilter d-block d-md-none d-lg-none"><i class="icon icon anm anm-times-l"></i></div>
        <div class="sidebar_tags">
          <!--Categories-->
          <div class="sidebar_widget categories filter-widget">
            <div class="widget-title">
              <h2>Categories</h2>
            </div>
            <div class="widget-content">
              <ul class="sidebar_categories">
                {% for link in linklists[section.settings.sidebar_menu].links %}
                  {% if link.links != blank %}
                    <li class="level1 sub-level"><a href="{{ link.url }}" class="site-nav">{{ link.title }}</a>
                      <ul class="sublinks">
                        {% for childlink in link.links %}
                          <li><a href="{{ childlink.url }}">{{ childlink.title }}</a></li>
                        {% endfor %}
                      </ul>
                    </li>
                  {% else %}
                    <li class="lvl-1"><a href="{{ link.url }}" class="site-nav">{{ link.title }}</a></li>
                  {% endif %}
                {% endfor %}
              </ul>
            </div>
          </div>
          <!--Categories-->

          <!--Price Filter-->
          <div class="sidebar_widget filterBox filter-widget">
            <div class="widget-title">
              <h2>Price</h2>
            </div>
            <form action="#" method="post" class="price-filter">
              <div id="slider-range" class="ui-slider ui-slider-horizontal ui-widget ui-widget-content ui-corner-all">
                <div class="ui-slider-range ui-widget-header ui-corner-all"></div>
                <span class="ui-slider-handle ui-state-default ui-corner-all" tabindex="0"></span>
                <span class="ui-slider-handle ui-state-default ui-corner-all" tabindex="0"></span>
              </div>
              <div class="row">
                <div class="col-6">
                  <p class="no-margin"><input id="amount" type="text"></p>
                </div>
                <div class="col-6 text-right margin-25px-top">
                  <button class="btn btn-secondary btn--small">filter</button>
                </div>
              </div>
            </form>
          </div>
          <!--End Price Filter-->

          <!--Size Swatches-->
          <div class="sidebar_widget filterBox filter-widget size-swacthes">
            <div class="widget-title">
              <h2>Size</h2>
            </div>
            <div class="filter-color swacth-list">
              <ul>
                <li><span class="swacth-btn checked">X</span></li>
                <li><span class="swacth-btn">XL</span></li>
                <li><span class="swacth-btn">XLL</span></li>
                <li><span class="swacth-btn">M</span></li>
                <li><span class="swacth-btn">L</span></li>
                <li><span class="swacth-btn">S</span></li>
                <li><span class="swacth-btn">XXXL</span></li>
                <li><span class="swacth-btn">XXL</span></li>
                <li><span class="swacth-btn">XS</span></span></li>
              </ul>
            </div>
          </div>
          <!--End Size Swatches-->

          <!--Color Swatches-->
          <div class="sidebar_widget filterBox filter-widget">
            <div class="widget-title">
              <h2>Color</h2>
            </div>
            <div class="filter-color swacth-list clearfix">
              <span class="swacth-btn black"></span>
              <span class="swacth-btn white checked"></span>
              <span class="swacth-btn red"></span>
              <span class="swacth-btn blue"></span>
              <span class="swacth-btn pink"></span>
              <span class="swacth-btn gray"></span>
              <span class="swacth-btn green"></span>
              <span class="swacth-btn orange"></span>
              <span class="swacth-btn yellow"></span>
              <span class="swacth-btn blueviolet"></span>
              <span class="swacth-btn brown"></span>
              <span class="swacth-btn darkGoldenRod"></span>
              <span class="swacth-btn darkGreen"></span>
              <span class="swacth-btn darkRed"></span>
              <span class="swacth-btn dimGrey"></span>
              <span class="swacth-btn khaki"></span>
            </div>
          </div>
          <!--End Color Swatches-->

          <!--Brand-->
          <div class="sidebar_widget filterBox filter-widget">
            <div class="widget-title">
              <h2>Brands</h2>
            </div>
            <ul>
              <li>
                <input type="checkbox" value="allen-vela" id="check1">
                <label for="check1"><span><span></span></span>Allen Vela</label>
              </li>
              <li>
                <input type="checkbox" value="oxymat" id="check3">
                <label for="check3"><span><span></span></span>Oxymat</label>
              </li>
              <li>
                <input type="checkbox" value="vanelas" id="check4">
                <label for="check4"><span><span></span></span>Vanelas</label>
              </li>
              <li>
                <input type="checkbox" value="pagini" id="check5">
                <label for="check5"><span><span></span></span>Pagini</label>
              </li>
              <li>
                <input type="checkbox" value="monark" id="check6">
                <label for="check6"><span><span></span></span>Monark</label>
              </li>
            </ul>
          </div>
          <!--End Brand-->
        </div>
      </div>
      <div class="col-12 col-sm-12 col-md-9 col-lg-9 main-col">
        <div class="productList">
          <!--Toolbar-->
          <button type="button" class="btn btn-filter d-block d-md-none d-lg-none"> Product Filters</button>
          <div class="toolbar">
            <div class="filters-toolbar-wrapper">
              <div class="row">
                <div class="col-12 col-sm-10 col-md-10 col-lg-8 filters-toolbar__item collection-view-as d-flex justify-content-start align-items-center">
                  <div class="d-flex">
                    {% render 'collection-sorting' %}
                  </div>
                  <div class="d-flex ml-4">
                    {% render 'filter-by-tag' %}
                  </div>
                </div>
                <div class="col-2 col-sm-2 col-md-2 col-lg-4 text-right">
                  <span class="filters-toolbar__product-count">Showing: {{ collection.all_products_count }}</span>
                </div>
              </div>
            </div>
          </div>
          <!--End Toolbar-->
          <div class="grid-products grid--view-items">
            <div data-next-url="{{paginate.next.url}}" class="products-on-page row">
              {% for product in collection.products %}
                <div class="col-6 col-sm-6 col-md-{{per_row}} col-lg-{{per_row}} item">
                  <!-- start product image -->
                  <div class="product-image">
                    <!-- start product image -->
                    <a href="{{ product.url | within: collection }}">
                      <!-- image -->
                      <img class="primary blur-up lazyload" data-src="{{  product.images[0] | img_url: 'master' }}"
                        src="{{  product.images[0] | img_url: 'master' }}" alt="image" title="product">
                      <!-- End image -->
                      <!-- Hover image -->
                      <img class="hover blur-up lazyload" data-src="{{  product.images[1] | img_url: 'master' }}"
                        src="{{  product.images[1] | img_url: 'master' }}" alt="image" title="product">
                      <!-- End hover image -->
                    </a>
                    <!-- end product image -->

                    <!-- Start product button -->
                    <form class="variants add" id="form-{{ product.handle }}" action="/cart/add" method="post">
                      <input type="hidden" name="id" value="{{ product.variants.first.id }}" />
                      <button onclick="document.getElementById('form-{{product.handle}}').submit()" class="btn btn-addto-cart" type="button">Add to cart</button>
                    </form>
                    <div class="button-set">
                      <div class="wishlist-btn">
                        <a class="wishlist add-to-wishlist" href="#" title="Add to Wishlist">
                          <i class="icon anm anm-heart-l"></i>
                        </a>
                      </div>
                      <div class="compare-btn">
                        <a class="compare add-to-compare" href="#" title="Add to Compare">
                          <i class="icon anm anm-random-r"></i>
                        </a>
                      </div>
                    </div>
                    <!-- end product button -->
                  </div>
                  <!-- end product image -->

                  <!--start product details -->
                  <div class="product-details text-center">
                    <!-- product name -->
                    <div class="product-name">
                      <a href="{{ product.url }}">{{ product.title | escape }}</a>
                    </div>
                    <!-- End product name -->
                    <!-- product price -->
                    <div class="product-price">
                      {% if product.compare_at_price > product.price %}
                        {% if product.price_varies %}
                          {%- assign sale_price = product.price | money -%}
                          {{ 'products.product.on_sale_from_html' | t: price: sale_price }}
                        {% else %}
                          <span class="price">{{ product.price | money }}</span>
                        {% endif %}
                      {% else %}
                        {% if product.price_varies %}
                          {%- assign price = product.price | money -%}
                          {{ 'products.product.from_text_html' | t: price: price }}
                        {% else %}
                          <span class="price">{{ product.price | money }}</span>
                        {% endif %}
                      {% endif %}

                      {% if product.compare_at_price > product.price %}
                        <span class="old-price"><s>{{ product.compare_at_price | money }}</s></span>
                      {% endif %}

                      {% unless product.available %}
                        {{ 'products.product.sold_out' | t }}
                      {% endunless %}
                    </div>
                    <!-- End product price -->
                  </div>
                  <!-- End product details -->
                </div>
              {% endfor %}
            </div>
          </div>
          <div class="load-more">
            <a class="btn load-more__btn" onclick="loadMoreProducts()">Load More</a>
            <div class="load-more__spinner"></div>
          </div>
        </div>
      </div>
      <!--End Main Content-->
    </div>
  </div>
{% endpaginate %}


{% schema %}
{
  "name": "Collection page",
  "settings": [
    {
      "type": "link_list",
      "id": "sidebar_menu",
      "label": "Sidebar Menu"
    },
    {
      "type": "range",
      "id": "products_per_page",
      "label": "Number of products",
      "default": 6,
      "min": 3,
      "max": 12,
      "step": 1
    },
    {
      "type": "select",
      "id": "products_per_row",
      "options": [
         { "value": "6", "label": "2"},
         { "value": "4", "label": "3"},
         { "value": "3", "label": "4"}
      ],
      "label": "Products per row"
    }

  ]
}
{% endschema %}